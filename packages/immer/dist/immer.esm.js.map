{"version":3,"file":"immer.esm.js","sources":["../src/index.ts"],"sourcesContent":["import { Plugin, Models } from '@rematch/core'\nimport Redux from 'redux'\nimport { enableES5, enableMapSet, produce } from 'immer'\n\nenableES5()\nenableMapSet()\n\nexport type ImmerPluginConfig = {\n\twhitelist?: string[]\n\tblacklist?: string[]\n}\n\nfunction wrapReducerWithImmer(reducer: Redux.Reducer) {\n\t// reducer must return value because literal don't support immer\n\treturn (state: any, payload: any): any =>\n\t\ttypeof state === 'object'\n\t\t\t? produce(state, (draft: any) => {\n\t\t\t\t\tconst next = reducer(draft, payload)\n\t\t\t\t\tif (typeof next === 'object') return next\n\t\t\t\t\treturn undefined\n\t\t\t  })\n\t\t\t: reducer(state, payload)\n}\n\nconst immerPlugin = <\n\tTModels extends Models<TModels>,\n\tTExtraModels extends Models<TModels> = {}\n>(\n\tconfig?: ImmerPluginConfig\n): Plugin<TModels, TExtraModels> => ({\n\tonReducer(reducer: Redux.Reducer, model: string): Redux.Reducer | void {\n\t\tif (\n\t\t\t!config ||\n\t\t\t(!config.whitelist && !config.blacklist) ||\n\t\t\t(config.whitelist && model in config.whitelist) ||\n\t\t\t(config.blacklist && !(model in config.blacklist))\n\t\t) {\n\t\t\treturn wrapReducerWithImmer(reducer)\n\t\t}\n\n\t\treturn undefined\n\t},\n})\n\nexport default immerPlugin\n"],"names":["enableES5","enableMapSet","wrapReducerWithImmer","reducer","state","payload","produce","draft","next","undefined","immerPlugin","config","onReducer","model","whitelist","blacklist"],"mappings":";;AAIAA,SAAS;AACTC,YAAY;;AAOZ,SAASC,oBAAT,CAA8BC,OAA9B;AAEC,SAAO,UAACC,KAAD,EAAaC,OAAb;AAAA,WACN,OAAOD,KAAP,KAAiB,QAAjB,GACGE,OAAO,CAACF,KAAD,EAAQ,UAACG,KAAD;AACf,UAAMC,IAAI,GAAGL,OAAO,CAACI,KAAD,EAAQF,OAAR,CAApB;AACA,UAAI,OAAOG,IAAP,KAAgB,QAApB,EAA8B,OAAOA,IAAP;AAC9B,aAAOC,SAAP;AACC,KAJM,CADV,GAMGN,OAAO,CAACC,KAAD,EAAQC,OAAR,CAPJ;AAAA,GAAP;AAQA;;AAED,IAAMK,WAAW,GAAG,SAAdA,WAAc,CAInBC,MAJmB;AAAA,SAKiB;AACpCC,IAAAA,SADoC,qBAC1BT,OAD0B,EACFU,KADE;AAEnC,UACC,CAACF,MAAD,IACC,CAACA,MAAM,CAACG,SAAR,IAAqB,CAACH,MAAM,CAACI,SAD9B,IAECJ,MAAM,CAACG,SAAP,IAAoBD,KAAK,IAAIF,MAAM,CAACG,SAFrC,IAGCH,MAAM,CAACI,SAAP,IAAoB,EAAEF,KAAK,IAAIF,MAAM,CAACI,SAAlB,CAJtB,EAKE;AACD,eAAOb,oBAAoB,CAACC,OAAD,CAA3B;AACA;;AAED,aAAOM,SAAP;AACA;AAZmC,GALjB;AAAA,CAApB;;;;"}